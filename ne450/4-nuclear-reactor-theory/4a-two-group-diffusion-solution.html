<!DOCTYPE html>
<html>
  <head>
    <title>4. Two group solution</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
      @import url(https://fonts.googleapis.com/css?family=Ubuntu:500);
      @import url(https://fonts.googleapis.com/css?family=Open+Sans);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Open Sans', sans-serif; }
      h1, h2, h3 {
        font-family: 'Ubuntu';
        font-weight: normal;
        }
      .remark-container {background-color: #F5F5F5; }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
      .remark-slide-content { background-color: #FFFAF0; font-size: 26px; 
                         h1 { font-size: 38px; } h2 {font-size: 32px; } h3 { font-size: 28px; }
       }
      .remark-slide-number { bottom: 8px; position: absolute; right: 8px; }
    </style>
  </head>
  <body>
<textarea id="source">
class: center, middle

# NE450
## PRINCIPLES OF NUCLEAR ENGINEERING  
### Nuclear reactor theory

#### 4
---
# Outcomes for the lecture

Solving coupled differential equations for flux
---
# Equation of continuity for neutrons describes behavior in a reactor

[rate of change of neutrons] = [production rate] - [absorption rate] - [leakage rate]

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\frac{d}{dt}\int_V&space;ndV=\int_V&space;sdV-\int_V\Sigma_A\phi&space;dV-\int_V\underline{J}\cdot\underline{n}dA" title="\large \frac{d}{dt}\int_V ndV=\int_V sdV-\int_V\Sigma_A\phi dV-\int_V\underline{J}\cdot\underline{n}dA" />

Apply some math and Green's theorem

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\int_V&space;\frac{\partial{n}}{\partial{t}}&space;dV=\int_V&space;sdV-\int_V\Sigma_A\phi&space;dV-\int_V\nabla{J}dV" title="\large \int_V \frac{\partial{n}}{\partial{t}} dV=\int_V sdV-\int_V\Sigma_A\phi dV-\int_V\nabla{J}dV" />
---
# Simplify the continutity equation

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\frac{\partial{n}}{\partial{t}}=s-\Sigma_A\phi-\nabla{J}" title="\large \frac{\partial{n}}{\partial{t}}=s-\Sigma_A\phi-\nabla{J}" />

Apply Fick's law

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\frac{\partial{n}}{\partial{t}}=D\nabla^2{\phi}-\Sigma_A\phi&plus;s" title="\large \frac{\partial{n}}{\partial{t}}=D\nabla^2{\phi}-\Sigma_A\phi+s" />  
<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\frac{1}{v}\frac{\partial{\phi}}{\partial{t}}=D\nabla^2{\phi}-\Sigma_A\phi&plus;s" title="\large \frac{1}{v}\frac{\partial{\phi}}{\partial{t}}=D\nabla^2{\phi}-\Sigma_A\phi+s" />

At steady state

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;D\nabla^2{\phi}-\Sigma_A\phi&plus;s=0" title="\large D\nabla^2{\phi}-\Sigma_A\phi+s=0" />
---
# Neutrons actually have a distribution in energy

Emitted in fission with continuous energy spectrum

To get around this ranges of neutrons grouped into 'bins'

Group diffusion theory

Each group has averaged parameters

Continuity equation then needs more terms
Scatter out of the group
Scatter into the group

Three group diffusion, etc.
---
![Multigroup neutron diffusion](img/multigroup.neutron.diffusion.jpg)
---
# Apply diffusion equation for group g

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;D_g\nabla^2{\phi_g}-\Sigma_A^g\phi_g-\sum_{h=g&plus;1}^N{\Sigma_{g&space;\rightarrow&space;h}\phi_g}&plus;\sum_{h=1}^{g-1}{\Sigma_{h&space;\rightarrow&space;g}\phi_h}&plus;s_g=0" title="\large D_g\nabla^2{\phi_g}-\Sigma_A^g\phi_g-\sum_{h=g+1}^N{\Sigma_{g \rightarrow h}\phi_g}+\sum_{h=1}^{g-1}{\Sigma_{h \rightarrow g}\phi_h}+s_g=0" />

So now, there is absorption in group g

But there is scatter from g to h which is a loss term

And then scatter into g from h which is an additional source term
---
# For a fast group and thermal group

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;D_1\nabla^2{\phi_1}-\Sigma_A^1\phi_1-\Sigma_{1&space;\rightarrow&space;2}\phi_1&plus;\Sigma_{2&space;\rightarrow&space;1}\phi_2&plus;s=0" title="\large D_1\nabla^2{\phi_1}-\Sigma_A^1\phi_1-\Sigma_{1 \rightarrow 2}\phi_1+\Sigma_{2 \rightarrow 1}\phi_2+s=0" />

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;D_2\nabla^2{\phi_2}-\Sigma_A^2\phi_2-\Sigma_{2&space;\rightarrow&space;1}\phi_2&plus;\Sigma_{1&space;\rightarrow&space;2}\phi_1=0" title="\large D_2\nabla^2{\phi_2}-\Sigma_A^2\phi_2-\Sigma_{2 \rightarrow 1}\phi_2+\Sigma_{1 \rightarrow 2}\phi_1=0" />

Neutrons can't scatter from the thermal group to the fast group

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;D_1\nabla^2{\phi_1}-\Sigma_A^1\phi_1-\Sigma_{1&space;\rightarrow&space;2}\phi_1&plus;s=0" title="\large D_1\nabla^2{\phi_1}-\Sigma_A^1\phi_1-\Sigma_{1 \rightarrow 2}\phi_1+s=0" />

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;D_2\nabla^2{\phi_2}-\Sigma_A^2\phi_2&plus;\Sigma_{1&space;\rightarrow&space;2}\phi_1=0" title="\large D_2\nabla^2{\phi_2}-\Sigma_A^2\phi_2+\Sigma_{1 \rightarrow 2}\phi_1=0" />
---
# Rearrange and compute the derivative

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\begin{align*}\frac{d^2\phi_1}{dx^2}-\frac{1}{K^2}\phi_1&plus;d=0\\\frac{d^2\phi_2}{dx^2}-\frac{1}{L^2}\phi_2&plus;\Sigma_{1&space;\rightarrow&space;2}\phi_1=0&space;\\L^2=\frac{D_2}{\Sigma_A^2}\\K^2=\frac{D_1}{\Sigma_A^1&plus;\Sigma_{1\rightarrow&space;2}}\\d=\frac{s}{D_1}\end{align*}"
title="\large \begin{align*}\frac{d^2\phi_1}{dx^2}-\frac{1}{K^2}\phi_1+d=0\\\frac{d^2\phi_2}{dx^2}-\frac{1}{L^2}\phi_2+\Sigma_{1 \rightarrow 2}\phi_1=0 \\L^2=\frac{D_2}{\Sigma_A^2}\\K^2=\frac{D_1}{\Sigma_A^1+\Sigma_{1\rightarrow 2}}\\d=\frac{s}{D_1}\end{align*}" />
---
# Solve the fast group first 

Assume

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\phi_1(x)=\phi_H(x)&plus;\phi_P(x)" title="\large \phi_1(x)=\phi_H(x)+\phi_P(x)" />

Solve

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\frac{d^2\phi_H}{dx^2}-\frac{1}{K^2}\phi_H=0" title="\large \frac{d^2\phi_H}{dx^2}-\frac{1}{K^2}\phi_H=0" />

<img src="https://latex.codecogs.com/gif.latex?\dpi{200}&space;\large&space;\phi_H(x)=Ae^{-\frac{x}{K}}&plus;Ce^{\frac{x}{K}}" title="\large \phi_H(x)=Ae^{-\frac{x}{K}}+Ce^{\frac{x}{K}}" />
---
# Assume particular solution

$\phi_P=B$ where B is an arbitrary constant

Let $\frac{d^2\phi}{dx^2} \equiv \phi''$ to clean up the mess and save on typing

Substitute into fast flux equation

$0-\frac{1}{K^2}B+d=0$

$B=dK^2$ 

So 

$\phi_P=dK^2$
---
# Then the fast flux is obtained

$\phi_1=A_1e^{-\frac{x}{K}}+C_1e^{\frac{x}{K}}+dK^2$
---
# Check

$\phi''_1=\frac{A_1}{K^2}e^{-\frac{x}{K}}+\frac{C_1}{K^2}e^{\frac{x}{K}}$

$(\frac{A_1}{K^2}e^{-\frac{x}{K}}+\frac{C_1}{K^2}e^{\frac{x}{K}})-\frac{1}{K^2}[A_1e^{-\frac{x}{K}}+C_1e^{\frac{x}{K}}+dK^2]+d=0$

$\frac{A_1}{K^2}e^{-\frac{x}{K}}+\frac{C_1}{K^2}e^{\frac{x}{K}}-\frac{A_1}{K^2}e^{-\frac{x}{K}}-\frac{C_1}{K^2}e^{\frac{x}{K}}-d+d=0$

All good
---
# Let's look at the thermal flux

$\phi''_2-\frac{1}{L^2}\phi_2+\Sigma_1\phi_1=0$

$\phi''_2-\frac{1}{L^2}\phi_2+\Sigma_1 A_1e^{-\frac{x}{K}}+\Sigma_1 C_1e^{\frac{x}{K}}+\Sigma_1 dK^2=0$

We let $\Sigma_{1 \rightarrow 2} \equiv \Sigma_1$ for less mess

Same procedure; assume

$\phi_2=\phi_H+\phi_P$

Then

$\phi''_H-\frac{1}{L^2}\phi_H=0$  

$\phi_H=A_2e^{-\frac{x}{L}}+C_2e^{\frac{x}{L}}$
---
# For the particular solution, apply the following [theorem](https://www.math.uh.edu/~etgen/5389-Chap3.pdf)

If $z_1(x)$ is a particular solution of 

$$y''+p(x)y'+q(x)y=f(x)$$

and $z_2(x)$ is a particular solution of 

$$y''+p(x)y'+q(x)y=g(x)$$

then $z=z_1(x)+z_2(x)$ is a particular solution of 

$$y''+p(x)y'+q(x)y=f(x)+g(x)$$

for any number of forcing functions
---
# So for this neutron diffusion problem

$\phi''_2-\frac{1}{L^2}\phi_2+\Sigma_1 A_1e^{-\frac{x}{K}}+\Sigma_1 C_1e^{\frac{x}{K}}+\Sigma_1 dK^2=0$  
$\phi_P=\phi_F+\phi_G+\phi_I$

Where we don't need to split up $L^2$ because the geometry is the same

$\phi''_F-\frac{1}{L^2}\phi_F+\Sigma_1 A_1 e^{-\frac{x}{K}}$  
$\phi''_G-\frac{1}{L^2}\phi_G+\Sigma_1 C_1 e^{\frac{x}{K}}$  
$\phi''_I-\frac{1}{L^2}\phi_I+\Sigma_1 dK^2$  

And

$\phi_F^P=B_1e^{-\frac{x}{K}} \rightarrow \phi''_F=\frac{B_1}{K^2}e^{-\frac{x}{K}}$  
$\phi_G^P=B_2e^{\frac{x}{K}} \rightarrow \phi''_G=\frac{B_2}{K^2}e^{\frac{x}{K}}$  
$\phi_I^P=B_3$  
---
# Therefore

$\frac{B_1}{K^2}e^{-\frac{x}{K}}-\frac{B_1}{L^2}e^{-\frac{x}{K}}+\Sigma_1 A_1 e^{-\frac{x}{K}}=0$

$\frac{B_2}{K^2}e^{\frac{x}{K}}-\frac{B_2}{L^2}e^{\frac{x}{K}}+\Sigma_1 C_1 e^{\frac{x}{K}}=0$

$0-\frac{B_3}{L^2}+\Sigma_1 dK^2=0$

Then 

$\frac{B_1}{K^2}-\frac{B_1}{L^2}+\Sigma_1 A_1 =0$

$\frac{B_2}{K^2}-\frac{B_2}{L^2}+\Sigma_1 C_1 =0$

$\frac{B_3}{L^2}=\Sigma_1 dK^2$
---
# Solve for the constants

$B_1=\frac{\Sigma_1 A_1 K^2 L^2}{K^2-L^2}$

$B_2=\frac{\Sigma_1 C_1 K^2 L^2}{K^2-L^2}$

$B_3=\Sigma_1dK^2L^2$

Then 

$\phi_F^P=\frac{\Sigma_1 A_1 K^2 L^2}{K^2-L^2} e^{-\frac{x}{K}}$

$\phi_G^P=\frac{\Sigma_1 C_1 K^2 L^2}{K^2-L^2} e^{\frac{x}{K}}$

$\phi_I^P=\Sigma_1 d K^2 L^2$
---
# Arrange to obtain thermal flux

$\phi_2=A_2e^{-\frac{x}{L}}+C_2e^{\frac{x}{L}}+\frac{\Sigma_1 A_1 K^2 L^2}{K^2-L^2} e^{-\frac{x}{K}}+\frac{\Sigma_1 C_1 K^2 L^2}{K^2-L^2} e^{\frac{x}{K}}+\Sigma_1 d K^2 L^2$
---
# Check

$\phi_2=A_2e^{-\frac{x}{L}}+C_2e^{\frac{x}{L}}+\frac{\Sigma_1 A_1 K^2 L^2}{K^2-L^2} e^{-\frac{x}{K}}+\frac{\Sigma_1 C_1 K^2 L^2}{K^2-L^2} e^{\frac{x}{K}}+\Sigma_1 d K^2 L^2$

$\phi''_2-\frac{1}{L^2}\phi_2+\Sigma_1\phi_1=0$  

$[\frac{A_2}{L^2}e^{-\frac{x}{L}}+\frac{C_2}{L^2}e^{\frac{x}{L}}+\frac{\Sigma_1 A_1 K^2 L^2}{(K^2-L^2)K^2} e^{-\frac{x}{K}}+\frac{\Sigma_1 C_1 K^2 L^2}{(K^2-L^2)K^2} e^{\frac{x}{K}}]$  

$-[\frac{A_2}{L^2}e^{-\frac{x}{L}}+\frac{C_2}{L^2}e^{\frac{x}{L}}+\frac{\Sigma_1 A_1 K^2 L^2}{(K^2-L^2)L^2} e^{-\frac{x}{K}}+\frac{\Sigma_1 C_1 K^2 L^2}{(K^2-L^2)L^2} e^{\frac{x}{K}}+\Sigma_1 d K^2]$  

$+[\Sigma_1A_1e^{-\frac{x}{K}}+\Sigma_1C_1e^{\frac{x}{K}}+\Sigma_1dK^2]=0$  
---
# Check on algebra

$(\frac{A_2}{L^2}-\frac{A_2}{L^2})e^{-\frac{x}{L}}+(\frac{C_2}{L^2}-\frac{C_2}{L^2})e^{\frac{x}{L}}+(\Sigma_1dK^2-\Sigma_1dK^2)$

$+[\frac{\Sigma_1A_1K^2L^2}{(K^2-L^2)K^2}-\frac{\Sigma_1A_1K^2L^2}{(K^2-L^2)L^2}+\Sigma_1A_1]e^{-\frac{x}{K}}$

$+[\frac{\Sigma_1C_1K^2L^2}{(K^2-L^2)K^2}-\frac{\Sigma_1C_1K^2L^2}{(K^2-L^2)L^2}+\Sigma_1C_1]e^{\frac{x}{K}}=0$

The first three terms equal zero. Taking the last two:

$[\frac{\Sigma_1A_1L^2}{K^2-L^2}-\frac{\Sigma_1A_1K^2}{K^2-L^2}+\frac{\Sigma_1A_1(K^2-L^2)}{K^2-L^2}]e^{-\frac{x}{K}}=0$

$[\frac{\Sigma_1C_1L^2}{K^2-L^2}-\frac{\Sigma_1C_1K^2}{K^2-L^2}+\frac{\Sigma_1C_1(K^2-L^2)}{K^2-L^2}]e^{\frac{x}{K}}=0$

All good
</textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/contrib/auto-render.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <script type="text/javascript">
        var options = {};
        var renderMath = function() {
            renderMathInElement(document.body, {delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false},
                    {left: "\\[", right: "\\]", display: true},
                    {left: "\\[", right: "\\]", display: false},
            ]});
        }
        var slideshow = remark.create({
          // Set the slideshow display ratio
          // Default: '4:3'
          // Alternatives: '16:9', ...
          ratio: '16:9',
          // Navigation options
          navigation: {
          // Enable or disable navigating using scroll
          // Default: true
          // Alternatives: false
          scroll: true,
          // Enable or disable navigation using touch
          // Default: true
          // Alternatives: false
          touch: true,
          // Enable or disable navigation using click
          // Default: false
          // Alternatives: true
          click: false
          },
          // Customize slide number label, either using a format string..
          slideNumberFormat: '%current%',
          // Enable or disable counting of incremental slides in the slide counting
          countIncrementalSlides: false 
          }, renderMath);
    </script>
    <script type="text/javascript">
     /**
      * a simple zoom in/out/reset for remark.js
      *
      * Hot key:
      *   + : zoom in
      *   - : zoom out
      *   0 : reset zoom
      *
      * CAVEAT: when switching between full screen and normal screen,
      *         the zoom factor may not function correctly.
      *         RELOAD the page, if necessary.
      *
      * 
      * @author William Yeh <william.pjyeh@gmail.com>
      * @date   2015-01-15
      *
      * @license Apache License, Version 2.0.
      * Copyright Â© 2015 William Yeh.
      */
      var ZOOM_TEXT_SELECTOR =
       ".remark-slide-content p"
       + "," + ".remark-slide-content .remark-code-line"
       ;

      var ZOOM_IMG_SELECTOR =
       ".remark-slide-content img:hover"
       ;

      var ZOOM_IMG_RULE;

      var zoom_factor = 100.0;
      document.body.style.zoom = "100%"
    
      function init_zoom_rule() {
       // @see http://davidwalsh.name/add-rules-stylesheets
       var styles = document.styleSheets[0];
       var index = styles.insertRule(
        ZOOM_IMG_SELECTOR + ' { transform:scale(1); }',
        styles.cssRules.length
        );

        ZOOM_IMG_RULE = styles.cssRules.item(index);
       }
    
      function apply_zoom() {
       var elements = document.querySelectorAll(ZOOM_TEXT_SELECTOR);
       //console.log('length:', elements.length);
       for (var i = 0; i < elements.length; ++i) {
        var item = elements[i];
        item.style.fontSize = zoom_factor.toString() + '%';
        }

        ZOOM_IMG_RULE.style.transform = 'scale(' + (zoom_factor / 100) + ')';
      }

      function zoom_in() {
       zoom_factor += 10;
       if (zoom_factor >= 200.0)  zoom_factor = 200.0;
       apply_zoom();
      }
    
      function zoom_out() {
       zoom_factor -= 10;
       if (zoom_factor <= 50.0)  zoom_factor = 50.0;
       apply_zoom();
      }

      function zoom_reset() {
       zoom_factor = 100.0;
       apply_zoom();
      }

      init_zoom_rule();
      window.addEventListener("keydown", function(event) {
       //console.log(event.keyCode);
       switch (event.keyCode) {
        case 187:  // '+': 187 in Chrome & Safari, 61 in FF
        case 61:  // '+': 187 in Chrome, 61 in FF
         zoom_in(); 
         break;

        case 189:  // '-': 189 in Chrome & Safari, 173 in FF
        case 173:  // '-': 189 in Chrome, 173 in FF
         zoom_out();
         break;
        case 48:   // '0'
         zoom_reset();
         break;
       }
      }, false);
    </script>
  </body>
</html>
